# Test 78: byte type handling and conversions variance testing
fn main(): int =>
    print("Test byte type handling and conversions:\n\n")

    # Test 1: byte literals
    print("1. byte literals:\n")
    var b1: byte = 0
    var b2: byte = 127
    var b3: byte = 255
    print($"  byte 0: {b1}\n")
    print($"  byte 127: {b2}\n")
    print($"  byte 255: {b3}\n")
    if b1 == 0 && b2 == 127 && b3 == 255 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 2: byte array creation
    print("\n2. byte array creation:\n")
    var arr1: byte[] = {10, 20, 30, 40, 50}
    print($"  Array length: {len(arr1)}\n")
    print($"  arr[0]: {arr1[0]}\n")
    print($"  arr[4]: {arr1[4]}\n")
    if len(arr1) == 5 && arr1[0] == 10 && arr1[4] == 50 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 3: Empty byte array
    print("\n3. Empty byte array:\n")
    var empty: byte[] = {}
    print($"  Empty array length: {len(empty)}\n")
    if len(empty) == 0 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 4: byte array push
    print("\n4. byte array push:\n")
    var arr2: byte[] = {1, 2}
    arr2.push(3)
    arr2.push(4)
    print($"  After push: length = {len(arr2)}\n")
    if len(arr2) == 4 && arr2[2] == 3 && arr2[3] == 4 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 5: byte array pop
    print("\n5. byte array pop:\n")
    var arr3: byte[] = {100, 101, 102}
    var popped: byte = arr3.pop()
    print($"  Popped value: {popped}\n")
    print($"  Length after pop: {len(arr3)}\n")
    if popped == 102 && len(arr3) == 2 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 6: byte array indexOf
    print("\n6. byte array indexOf:\n")
    var arr4: byte[] = {10, 20, 30, 40, 50}
    var idx1: int = arr4.indexOf(30)
    var idx2: int = arr4.indexOf(99)
    print($"  indexOf(30): {idx1}\n")
    print($"  indexOf(99): {idx2}\n")
    if idx1 == 2 && idx2 == -1 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 7: byte array contains
    print("\n7. byte array contains:\n")
    var arr5: byte[] = {5, 10, 15}
    var has10: bool = arr5.contains(10)
    var has20: bool = arr5.contains(20)
    print($"  contains(10): {has10}\n")
    print($"  contains(20): {has20}\n")
    if has10 && !has20 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 8: byte array clone
    print("\n8. byte array clone:\n")
    var arr6: byte[] = {1, 2, 3}
    var cloned: byte[] = arr6.clone()
    cloned[0] = 99
    print($"  Original[0]: {arr6[0]}\n")
    print($"  Clone[0]: {cloned[0]}\n")
    if arr6[0] == 1 && cloned[0] == 99 =>
        print("  PASS: Clone is independent\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 9: byte to string conversion (toHex)
    print("\n9. byte array toHex:\n")
    var hexBytes: byte[] = {72, 101, 108, 108, 111}
    var hexStr: str = hexBytes.toHex()
    print($"  'Hello' as hex: {hexStr}\n")
    if hexStr == "48656c6c6f" =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 10: byte array toString
    print("\n10. byte array toString:\n")
    var strBytes: byte[] = {65, 66, 67}
    var str10: str = strBytes.toString()
    print($"  toString: '{str10}'\n")
    if str10 == "ABC" =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 11: byte array toBase64
    print("\n11. byte array toBase64:\n")
    var b64Bytes: byte[] = {77, 97, 110}
    var b64Str: str = b64Bytes.toBase64()
    print($"  'Man' as base64: {b64Str}\n")
    if b64Str == "TWFu" =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 12: String to bytes
    print("\n12. String to bytes:\n")
    var testStr: str = "Hello"
    var bytes12: byte[] = testStr.toBytes()
    print($"  'Hello' length as bytes: {len(bytes12)}\n")
    if len(bytes12) == 5 && bytes12[0] == 72 && bytes12[4] == 111 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 13: Bytes.fromHex
    print("\n13. Bytes.fromHex:\n")
    var fromHex: byte[] = Bytes.fromHex("414243")
    print($"  fromHex('414243') length: {len(fromHex)}\n")
    if len(fromHex) == 3 && fromHex[0] == 65 && fromHex[2] == 67 =>
        print("  PASS: ABC\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 14: Bytes.fromBase64
    print("\n14. Bytes.fromBase64:\n")
    var fromB64: byte[] = Bytes.fromBase64("SGVsbG8=")
    var decoded: str = fromB64.toString()
    print($"  fromBase64('SGVsbG8=') decoded: '{decoded}'\n")
    if decoded == "Hello" =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 15: Round-trip encoding
    print("\n15. Round-trip encoding:\n")
    var original: byte[] = {0, 127, 255}
    var hexRoundTrip: byte[] = Bytes.fromHex(original.toHex())
    if len(hexRoundTrip) == 3 && hexRoundTrip[0] == 0 && hexRoundTrip[1] == 127 && hexRoundTrip[2] == 255 =>
        print("  PASS: Hex round-trip preserved\n")
    else =>
        print("  FAIL\n")
        return 1

    print("\nAll byte type tests passed!\n")
    return 0
