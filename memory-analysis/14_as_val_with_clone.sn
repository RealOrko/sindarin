// Test: clone() method combined with function as val param

fn process(arr: int[] as val): int =>
    // arr is a copy - modifications are local
    var sum: int = 0
    for item in arr =>
        sum = sum + item
    return sum

fn main(): void =>
    var original: int[] = {10, 20, 30}

    // Clone using .clone() method
    var copy: int[] = original.clone()
    copy.push(40)

    print("Original: ")
    print(original)
    print("\n")

    print("Copy (with extra element): ")
    print(copy)
    print("\n")

    // Pass original to function with as val
    var sum: int = process(original)
    print($"Sum of original: {sum}\n")

    // Verify original unchanged
    if original.length == 3 =>
        print("SUCCESS: clone and as val work correctly\n")
    else =>
        print("FAILURE: original was modified\n")
