# Test string splitting methods

fn main(): int =>
    # Test splitWhitespace - splits on any whitespace
    var text1: str = "hello world  foo   bar"
    var words: str[] = text1.splitWhitespace()
    print("Words count: ")
    println(words.length)
    print("Word 0: ")
    println(words[0])
    print("Word 1: ")
    println(words[1])
    print("Word 2: ")
    println(words[2])
    print("Word 3: ")
    println(words[3])

    # Test splitWhitespace with tabs and newlines
    var text2: str = "a\tb\nc  d"
    var words2: str[] = text2.splitWhitespace()
    print("Mixed whitespace count: ")
    println(words2.length)
    print("Mixed 0: ")
    println(words2[0])
    print("Mixed 1: ")
    println(words2[1])
    print("Mixed 2: ")
    println(words2[2])
    print("Mixed 3: ")
    println(words2[3])

    # Test splitWhitespace on empty string
    var empty: str = ""
    var emptyWords: str[] = empty.splitWhitespace()
    print("Empty split count: ")
    println(emptyWords.length)

    # Test splitWhitespace with only whitespace
    var onlyWs: str = "   \t\n   "
    var onlyWsWords: str[] = onlyWs.splitWhitespace()
    print("Only whitespace count: ")
    println(onlyWsWords.length)

    # Test splitLines with Unix line endings
    var unixText: str = "line1\nline2\nline3"
    var unixLines: str[] = unixText.splitLines()
    print("Unix lines count: ")
    println(unixLines.length)
    print("Unix line 0: ")
    println(unixLines[0])
    print("Unix line 1: ")
    println(unixLines[1])
    print("Unix line 2: ")
    println(unixLines[2])

    # Test splitLines with Windows line endings (\r\n)
    var winText: str = "line1\r\nline2\r\nline3"
    var winLines: str[] = winText.splitLines()
    print("Windows lines count: ")
    println(winLines.length)
    print("Win line 0: ")
    println(winLines[0])
    print("Win line 1: ")
    println(winLines[1])
    print("Win line 2: ")
    println(winLines[2])

    # Test splitLines with old Mac line endings (\r)
    var macText: str = "line1\rline2\rline3"
    var macLines: str[] = macText.splitLines()
    print("Mac lines count: ")
    println(macLines.length)
    print("Mac line 0: ")
    println(macLines[0])
    print("Mac line 1: ")
    println(macLines[1])
    print("Mac line 2: ")
    println(macLines[2])

    # Test splitLines with mixed endings
    var mixedText: str = "unix\nwin\r\nmac\r"
    var mixedLines: str[] = mixedText.splitLines()
    print("Mixed lines count: ")
    println(mixedLines.length)
    print("Mixed line 0: ")
    println(mixedLines[0])
    print("Mixed line 1: ")
    println(mixedLines[1])
    print("Mixed line 2: ")
    println(mixedLines[2])

    # Test splitLines on empty string
    var emptyLines: str[] = "".splitLines()
    print("Empty lines count: ")
    println(emptyLines.length)

    # Test isBlank
    print("Empty isBlank: ")
    println("".isBlank())
    print("Spaces isBlank: ")
    println("   ".isBlank())
    print("Tabs isBlank: ")
    println("\t\t".isBlank())
    print("Mixed ws isBlank: ")
    println(" \t\n\r ".isBlank())
    print("Text isBlank: ")
    println("hello".isBlank())
    print("Text with spaces isBlank: ")
    println(" hello ".isBlank())

    # Integration: Read file and use these methods
    var testFile: str = "/tmp/test_string_split.txt"
    TextFile.writeAll(testFile, "word1 word2 word3\nline2 has words\nline3")
    var content: str = TextFile.readAll(testFile)
    var lines: str[] = content.splitLines()
    print("File lines count: ")
    println(lines.length)

    var i: int = 0
    for i in 0..lines.length =>
        if lines[i].isBlank() =>
            continue
        var lineWords: str[] = lines[i].splitWhitespace()
        print("Line ")
        print(i)
        print(" word count: ")
        println(lineWords.length)

    # Cleanup
    TextFile.delete(testFile)

    println("All string split tests completed!")
    return 0
