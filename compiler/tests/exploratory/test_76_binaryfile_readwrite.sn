# Test 76: BinaryFile instance read/write methods variance testing
fn main(): int =>
    print("Test BinaryFile instance read/write methods:\n\n")

    # Setup: Create test file with known content
    var testData: byte[] = {65, 66, 67, 68, 69}
    BinaryFile.writeAll("/tmp/test_bf_76.bin", testData)

    # Test 1: open and readByte
    print("1. open and readByte:\n")
    var f1: BinaryFile = BinaryFile.open("/tmp/test_bf_76.bin")
    var b1: int = f1.readByte()
    print($"  First byte: {b1}\n")
    if b1 == 65 =>
        print("  PASS: Got 'A' (65)\n")
    else =>
        print("  FAIL: Expected 65\n")
        return 1
    f1.close()

    # Test 2: Multiple readByte calls
    print("\n2. Multiple readByte calls:\n")
    var f2: BinaryFile = BinaryFile.open("/tmp/test_bf_76.bin")
    var byte2a: int = f2.readByte()
    var byte2b: int = f2.readByte()
    var byte2c: int = f2.readByte()
    var byte2d: int = f2.readByte()
    var byte2e: int = f2.readByte()
    f2.close()
    print($"  Bytes: {byte2a}, {byte2b}, {byte2c}, {byte2d}, {byte2e}\n")
    if byte2a == 65 && byte2b == 66 && byte2c == 67 && byte2d == 68 && byte2e == 69 =>
        print("  PASS: All bytes correct\n")
    else =>
        print("  FAIL: Byte values mismatch\n")
        return 1

    # Test 3: readByte at EOF
    print("\n3. readByte at EOF:\n")
    var f3: BinaryFile = BinaryFile.open("/tmp/test_bf_76.bin")
    var allF3: byte[] = f3.readAll()
    var eofByte: int = f3.readByte()
    f3.close()
    print($"  readByte at EOF: {eofByte}\n")
    if eofByte == -1 =>
        print("  PASS: Returns -1 at EOF\n")
    else =>
        print("  FAIL: Should return -1\n")
        return 1

    # Test 4: readBytes
    print("\n4. readBytes:\n")
    var f4: BinaryFile = BinaryFile.open("/tmp/test_bf_76.bin")
    var bytes4: byte[] = f4.readBytes(3)
    f4.close()
    print($"  Read {len(bytes4)} bytes\n")
    if len(bytes4) == 3 && bytes4[0] == 65 && bytes4[2] == 67 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 5: readBytes partial then more
    print("\n5. readBytes partial then more:\n")
    var f5: BinaryFile = BinaryFile.open("/tmp/test_bf_76.bin")
    var first2: byte[] = f5.readBytes(2)
    var next2: byte[] = f5.readBytes(2)
    f5.close()
    print($"  First 2: {first2[0]}, {first2[1]}\n")
    print($"  Next 2: {next2[0]}, {next2[1]}\n")
    if first2[0] == 65 && first2[1] == 66 && next2[0] == 67 && next2[1] == 68 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 6: readAll (instance)
    print("\n6. readAll (instance):\n")
    var f6: BinaryFile = BinaryFile.open("/tmp/test_bf_76.bin")
    var all6: byte[] = f6.readAll()
    f6.close()
    print($"  readAll length: {len(all6)}\n")
    if len(all6) == 5 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 7: writeByte
    print("\n7. writeByte:\n")
    var f7: BinaryFile = BinaryFile.open("/tmp/test_bf_76_write.bin")
    f7.writeByte(88)
    f7.writeByte(89)
    f7.writeByte(90)
    f7.close()
    var read7: byte[] = BinaryFile.readAll("/tmp/test_bf_76_write.bin")
    print($"  Written bytes: {read7[0]}, {read7[1]}, {read7[2]}\n")
    if len(read7) == 3 && read7[0] == 88 && read7[1] == 89 && read7[2] == 90 =>
        print("  PASS: XYZ written\n")
    else =>
        print("  FAIL\n")
        return 1
    BinaryFile.delete("/tmp/test_bf_76_write.bin")

    # Test 8: writeBytes
    print("\n8. writeBytes:\n")
    var f8: BinaryFile = BinaryFile.open("/tmp/test_bf_76_writebytes.bin")
    var toWrite: byte[] = {100, 101, 102, 103}
    f8.writeBytes(toWrite)
    f8.close()
    var read8: byte[] = BinaryFile.readAll("/tmp/test_bf_76_writebytes.bin")
    print($"  Written length: {len(read8)}\n")
    if len(read8) == 4 && read8[0] == 100 && read8[3] == 103 =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1
    BinaryFile.delete("/tmp/test_bf_76_writebytes.bin")

    # Test 9: Mixed writeByte and writeBytes
    print("\n9. Mixed writeByte and writeBytes:\n")
    var f9: BinaryFile = BinaryFile.open("/tmp/test_bf_76_mixed.bin")
    f9.writeByte(1)
    var moreBytes: byte[] = {2, 3}
    f9.writeBytes(moreBytes)
    f9.writeByte(4)
    f9.close()
    var read9: byte[] = BinaryFile.readAll("/tmp/test_bf_76_mixed.bin")
    if len(read9) == 4 && read9[0] == 1 && read9[1] == 2 && read9[2] == 3 && read9[3] == 4 =>
        print("  PASS: 1, 2, 3, 4\n")
    else =>
        print("  FAIL\n")
        return 1
    BinaryFile.delete("/tmp/test_bf_76_mixed.bin")

    # Test 10: flush
    print("\n10. flush:\n")
    var f10: BinaryFile = BinaryFile.open("/tmp/test_bf_76_flush.bin")
    f10.writeByte(42)
    f10.flush()
    f10.close()
    var read10: byte[] = BinaryFile.readAll("/tmp/test_bf_76_flush.bin")
    if len(read10) == 1 && read10[0] == 42 =>
        print("  PASS: flush worked\n")
    else =>
        print("  FAIL\n")
        return 1
    BinaryFile.delete("/tmp/test_bf_76_flush.bin")

    # Test 11: hasBytes
    print("\n11. hasBytes:\n")
    var f11: BinaryFile = BinaryFile.open("/tmp/test_bf_76.bin")
    var hasBefore: bool = f11.hasBytes()
    var allBytes11: byte[] = f11.readAll()
    var hasAfter: bool = f11.hasBytes()
    f11.close()
    print($"  hasBytes before read: {hasBefore}\n")
    print($"  hasBytes after readAll: {hasAfter}\n")
    if hasBefore && !hasAfter =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Test 12: isEof
    print("\n12. isEof:\n")
    var f12: BinaryFile = BinaryFile.open("/tmp/test_bf_76.bin")
    var eofBefore: bool = f12.isEof()
    var allBytes12: byte[] = f12.readAll()
    var eofAfter: bool = f12.isEof()
    f12.close()
    print($"  isEof before read: {eofBefore}\n")
    print($"  isEof after readAll: {eofAfter}\n")
    if !eofBefore && eofAfter =>
        print("  PASS\n")
    else =>
        print("  FAIL\n")
        return 1

    # Cleanup
    BinaryFile.delete("/tmp/test_bf_76.bin")

    print("\nAll BinaryFile read/write method tests passed!\n")
    return 0
