// Test 122: Empty file reading
// Tests behavior when reading empty files

fn main(): int =>
    print("Test empty file reading:\n\n")
    var errors: int = 0

    // Create empty text file
    var empty_txt: str = "/tmp/empty_test.txt"
    TextFile.writeAll(empty_txt, "")

    // Test 1: TextFile.readAll on empty file
    print("Test 1 - TextFile.readAll on empty file:\n")
    var content: str = TextFile.readAll(empty_txt)
    print($"  Content length: {content.length}\n")
    if content.length != 0 =>
        print("  FAIL: should be empty string\n")
        errors++

    // Test 2: Instance readAll on empty file
    print("\nTest 2 - Instance readAll on empty file:\n")
    var f1: TextFile = TextFile.open(empty_txt)
    var instance_content: str = f1.readAll()
    print($"  Instance readAll length: {instance_content.length}\n")
    if instance_content.length != 0 =>
        print("  FAIL: instance readAll should return empty string\n")
        errors++
    f1.close()

    // Test 3: readChar on empty file returns -1
    print("\nTest 3 - readChar on empty file:\n")
    var f2: TextFile = TextFile.open(empty_txt)
    var ch: int = f2.readChar()
    print($"  readChar result: {ch}\n")
    if ch != -1 =>
        print("  FAIL: readChar on empty file should return -1 (EOF)\n")
        errors++
    f2.close()

    // Test 4: Empty binary file
    print("\nTest 4 - Empty binary file:\n")
    var empty_bin: str = "/tmp/empty_test.bin"
    var empty_bytes: byte[] = {}
    BinaryFile.writeAll(empty_bin, empty_bytes)

    var read_bytes: byte[] = BinaryFile.readAll(empty_bin)
    print($"  Binary readAll length: {read_bytes.length}\n")
    if read_bytes.length != 0 =>
        print("  FAIL: should be empty byte array\n")
        errors++

    // Test 5: BinaryFile readByte on empty file
    print("\nTest 5 - BinaryFile readByte on empty file:\n")
    var bf: BinaryFile = BinaryFile.open(empty_bin)
    var byte_read: int = bf.readByte()
    print($"  readByte on empty: {byte_read}\n")
    if byte_read != -1 =>
        print("  FAIL: readByte on empty should return -1\n")
        errors++

    var size: int = bf.size
    print($"  size property: {size}\n")
    if size != 0 =>
        print("  FAIL: size should be 0\n")
        errors++
    bf.close()

    // Cleanup
    TextFile.delete(empty_txt)
    BinaryFile.delete(empty_bin)

    // Results
    if errors == 0 =>
        print("\nAll empty file tests PASSED!\n")
    if errors > 0 =>
        print($"\n{errors} tests FAILED!\n")

    return 0
