# Test sdk/math module

import "../../sdk/math" as math

fn main(): int =>
    print("=== SDK Math Module Test ===\n\n")

    # Test constants
    print("--- Constants ---\n")
    print($"pi = {math.pi()}\n")
    print($"e = {math.e()}\n")
    print($"tau = {math.tau()}\n")
    print($"phi = {math.phi()}\n")
    print($"sqrt2 = {math.sqrt2()}\n")

    # Test basic trig
    print("\n--- Trigonometry ---\n")
    var angle: double = math.deg_to_rad(45.0)
    print($"sin(45deg) = {math.sin(angle)}\n")
    print($"cos(45deg) = {math.cos(angle)}\n")
    print($"tan(45deg) = {math.tan(angle)}\n")

    # Test sqrt and pow
    print("\n--- Power Functions ---\n")
    print($"sqrt(2) = {math.sqrt(2.0)}\n")
    print($"cbrt(8) = {math.cbrt(8.0)}\n")
    print($"pow(2, 10) = {math.pow(2.0, 10.0)}\n")
    print($"hypot(3, 4) = {math.hypot(3.0, 4.0)}\n")

    # Test log and exp
    print("\n--- Exponential/Logarithmic ---\n")
    print($"exp(1) = {math.exp(1.0)}\n")
    print($"log(e) = {math.log(math.e())}\n")
    print($"log10(100) = {math.log10(100.0)}\n")
    print($"log2(8) = {math.log2(8.0)}\n")

    # Test rounding
    print("\n--- Rounding ---\n")
    print($"floor(2.7) = {math.floor(2.7)}\n")
    print($"ceil(2.3) = {math.ceil(2.3)}\n")
    print($"round(2.5) = {math.round(2.5)}\n")
    print($"trunc(-2.7) = {math.trunc(-2.7)}\n")

    # Test integer helpers
    print("\n--- Integer Helpers ---\n")
    print($"abs_i(-42) = {math.abs_i(-42)}\n")
    print($"min_i(10, 20) = {math.min_i(10, 20)}\n")
    print($"max_i(10, 20) = {math.max_i(10, 20)}\n")
    print($"clamp_i(15, 0, 10) = {math.clamp_i(15, 0, 10)}\n")
    print($"sign_i(-5) = {math.sign_i(-5)}\n")

    # Test double helpers
    print("\n--- Double Helpers ---\n")
    print($"abs_d(-3.14) = {math.abs_d(-3.14)}\n")
    print($"min_d(1.5, 2.5) = {math.min_d(1.5, 2.5)}\n")
    print($"max_d(1.5, 2.5) = {math.max_d(1.5, 2.5)}\n")
    print($"clamp_d(1.5, 0.0, 1.0) = {math.clamp_d(1.5, 0.0, 1.0)}\n")

    # Test safe wrappers
    print("\n--- Safe Wrappers ---\n")
    print($"safe_sqrt(-1) = {math.safe_sqrt(-1.0)}\n")
    print($"safe_sqrt(4) = {math.safe_sqrt(4.0)}\n")
    print($"safe_asin(2.0) = {math.safe_asin(2.0)}\n")

    # Test utility functions
    print("\n--- Utilities ---\n")
    print($"lerp(0, 100, 0.5) = {math.lerp(0.0, 100.0, 0.5)}\n")
    print($"distance_2d(0,0,3,4) = {math.distance_2d(0.0, 0.0, 3.0, 4.0)}\n")
    print($"smoothstep(0, 1, 0.5) = {math.smoothstep(0.0, 1.0, 0.5)}\n")

    # Test hyperbolic
    print("\n--- Hyperbolic ---\n")
    print($"sinh(1) = {math.sinh(1.0)}\n")
    print($"cosh(1) = {math.cosh(1.0)}\n")
    print($"tanh(1) = {math.tanh(1.0)}\n")

    print("=== SDK Math Float Test ===\n\n")

    # Test float constants
    print("--- Float Constants ---\n")
    print($"pi_f = {math.pi_f()}\n")
    print($"e_f = {math.e_f()}\n")
    print($"tau_f = {math.tau_f()}\n")
    print($"phi_f = {math.phi_f()}\n")
    print($"sqrt2_f = {math.sqrt2_f()}\n")

    # Test basic trig (float)
    print("\n--- Trigonometry (float) ---\n")
    var angle_f: float = math.deg_to_rad_f(45.0)
    print($"sinf(45deg) = {math.sinf(angle_f)}\n")
    print($"cosf(45deg) = {math.cosf(angle_f)}\n")
    print($"tanf(45deg) = {math.tanf(angle_f)}\n")

    # Test sqrt and pow (float)
    print("\n--- Power Functions (float) ---\n")
    print($"sqrtf(2) = {math.sqrtf(2.0)}\n")
    print($"cbrtf(8) = {math.cbrtf(8.0)}\n")
    print($"powf(2, 10) = {math.powf(2.0, 10.0)}\n")
    print($"hypotf(3, 4) = {math.hypotf(3.0, 4.0)}\n")

    # Test log and exp (float)
    print("\n--- Exponential/Logarithmic (float) ---\n")
    print($"expf(1) = {math.expf(1.0)}\n")
    print($"logf(e_f) = {math.logf(math.e_f())}\n")
    print($"log10f(100) = {math.log10f(100.0)}\n")
    print($"log2f(8) = {math.log2f(8.0)}\n")

    # Test rounding (float)
    print("\n--- Rounding (float) ---\n")
    print($"floorf(2.7) = {math.floorf(2.7)}\n")
    print($"ceilf(2.3) = {math.ceilf(2.3)}\n")
    print($"roundf(2.5) = {math.roundf(2.5)}\n")
    print($"truncf(-2.7) = {math.truncf(-2.7)}\n")

    # Test float helpers
    print("\n--- Float Helpers ---\n")
    print($"abs_f(-3.14) = {math.abs_f(-3.14)}\n")
    print($"min_f(1.5, 2.5) = {math.min_f(1.5, 2.5)}\n")
    print($"max_f(1.5, 2.5) = {math.max_f(1.5, 2.5)}\n")
    print($"clamp_f(1.5, 0.0, 1.0) = {math.clamp_f(1.5, 0.0, 1.0)}\n")
    print($"sign_f(-5.0) = {math.sign_f(-5.0)}\n")

    # Test safe wrappers (float)
    print("\n--- Safe Wrappers (float) ---\n")
    print($"safe_sqrt_f(-1) = {math.safe_sqrt_f(-1.0)}\n")
    print($"safe_sqrt_f(4) = {math.safe_sqrt_f(4.0)}\n")
    print($"safe_asin_f(2.0) = {math.safe_asin_f(2.0)}\n")
    print($"safe_log_f(-1) = {math.safe_log_f(-1.0)}\n")

    # Test utility functions (float)
    print("\n--- Utilities (float) ---\n")
    print($"lerp_f(0, 100, 0.5) = {math.lerp_f(0.0, 100.0, 0.5)}\n")
    print($"distance_2d_f(0,0,3,4) = {math.distance_2d_f(0.0, 0.0, 3.0, 4.0)}\n")
    print($"smoothstep_f(0, 1, 0.5) = {math.smoothstep_f(0.0, 1.0, 0.5)}\n")

    # Test hyperbolic (float)
    print("\n--- Hyperbolic (float) ---\n")
    print($"sinhf(1) = {math.sinhf(1.0)}\n")
    print($"coshf(1) = {math.coshf(1.0)}\n")
    print($"tanhf(1) = {math.tanhf(1.0)}\n")

    # Verify float vs double precision difference
    print("\n--- Float vs Double Precision ---\n")
    var d_pi: double = math.pi()
    var f_pi: float = math.pi_f()
    print($"double pi = {d_pi}\n")
    print($"float pi  = {f_pi}\n")

    print("\n=== All float tests completed! ===\n")

    print("\n=== All tests completed! ===\n")
    
    return 0
