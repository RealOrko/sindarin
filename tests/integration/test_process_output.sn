// Test Process stdout and stderr capture
// Cross-platform using Python

fn main(): int =>
    var p1: Process = Process.run("python", {"-c", "print('stdout test')"})
    print($"stdout: {p1.stdout.trim()}\n")

    var p2: Process = Process.run("python", {"-c", "import sys; sys.stderr.write('stderr test\\n')"})
    print($"stderr: {p2.stderr.trim()}\n")

    var p3: Process = Process.run("python", {"-c", "import sys; print('out'); sys.stderr.write('err\\n')"})
    print($"both stdout: {p3.stdout.trim()}\n")
    print($"both stderr: {p3.stderr.trim()}\n")

    var p4: Process = Process.run("python", {"-c", "print('line1'); print('line2'); print('line3')"})
    var multi: str = p4.stdout.replace("\r", "").trim()
    print($"multiline:\n{multi}\n")

    var p5: Process = Process.run("python", {"-c", "pass"})
    if p5.stdout == "" =>
        print("empty stdout: true\n")
    else =>
        print("empty stdout: false\n")

    return 0
