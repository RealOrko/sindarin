// Test: Handling large stdout/stderr output
// Verifies that processes with large output are captured correctly

fn main(): void =>
    print("Testing large process output\n")

    // Generate 1000 lines of output using seq
    var p: Process = Process.run("sh", {"-c", "seq 1 1000"})

    // Check exit code
    if p.exitCode != 0 =>
        print("FAILURE: seq command failed\n")
        return

    // Check output contains expected lines
    var output: str = p.stdout
    var len: int = output.length

    // seq 1 1000 produces about 3890 characters
    if len > 3000 =>
        print($"Output length: {len} chars\n")
        print("SUCCESS: Large output captured correctly\n")
    else =>
        print($"FAILURE: Output too short ({len} chars)\n")

    // Verify contains expected values
    if output.contains("500") && output.contains("999") && output.contains("1000") =>
        print("SUCCESS: Output contains expected values\n")
    else =>
        print("FAILURE: Missing expected values in output\n")
